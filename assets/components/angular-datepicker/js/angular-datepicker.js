!function(e,a){"use strict";var t=864e5,n=function(){return a.userAgent&&(a.userAgent.match(/Android/i)||a.userAgent.match(/webOS/i)||a.userAgent.match(/iPhone/i)||a.userAgent.match(/iPad/i)||a.userAgent.match(/iPod/i)||a.userAgent.match(/BlackBerry/i)||a.userAgent.match(/Windows Phone/i))?!0:void 0}(),i=function(e,a,t){return t&&(n=!1),n?['<div class="_720kb-datepicker-calendar-header">','<div class="_720kb-datepicker-calendar-header-middle _720kb-datepicker-mobile-item _720kb-datepicker-calendar-month">','<select ng-model="month" title="{{ dateMonthTitle }}" ng-change="selectedMonthHandle(month)">','<option ng-repeat="item in months" ng-selected="item === month" ng-disabled=\'!isSelectableMaxDate(item + " " + day + ", " + year) || !isSelectableMinDate(item + " " + day + ", " + year)\' ng-value="$index + 1" value="$index + 1">',"{{ item }}","</option>","</select>","</div>","</div>",'<div class="_720kb-datepicker-calendar-header">','<div class="_720kb-datepicker-calendar-header-middle _720kb-datepicker-mobile-item _720kb-datepicker-calendar-month">','<select ng-model="mobileYear" title="{{ dateYearTitle }}" ng-change="setNewYear(mobileYear)">','<option ng-repeat="item in paginationYears track by $index" ng-selected="year === item" ng-disabled="!isSelectableMinYear(item) || !isSelectableMaxYear(item)" ng-value="item" value="item">',"{{ item }}","</option>","</select>","</div>","</div>"]:['<div class="_720kb-datepicker-calendar-header">','<div class="_720kb-datepicker-calendar-header-left">','<a class="_720kb-datepicker-calendar-month-button" href="javascript:void(0)" ng-class="{\'_720kb-datepicker-item-hidden\': !willPrevMonthBeSelectable()}" ng-click="prevMonth()" title="{{ buttonPrevTitle }}">',e,"</a>","</div>",'<div class="_720kb-datepicker-calendar-header-middle _720kb-datepicker-calendar-month">',"{{month}}&nbsp;",'<a href="javascript:void(0)" ng-click="paginateYears(year); showYearsPagination = !showYearsPagination;">',"<span>","{{year}}","<i ng-class=\"{'_720kb-datepicker-calendar-header-closed-pagination': !showYearsPagination, '_720kb-datepicker-calendar-header-opened-pagination': showYearsPagination}\"></i>","</span>","</a>","</div>",'<div class="_720kb-datepicker-calendar-header-right">','<a class="_720kb-datepicker-calendar-month-button" ng-class="{\'_720kb-datepicker-item-hidden\': !willNextMonthBeSelectable()}" href="javascript:void(0)" ng-click="nextMonth()" title="{{ buttonNextTitle }}">',a,"</a>","</div>","</div>"]},r=function(e,a){return['<div class="_720kb-datepicker-calendar-header" ng-show="showYearsPagination">','<div class="_720kb-datepicker-calendar-years-pagination">','<a ng-class="{\'_720kb-datepicker-active\': y === year, \'_720kb-datepicker-disabled\': !isSelectableMaxYear(y) || !isSelectableMinYear(y)}" href="javascript:void(0)" ng-click="setNewYear(y)" ng-repeat="y in paginationYears track by $index">',"{{y}}","</a>","</div>",'<div class="_720kb-datepicker-calendar-years-pagination-pages">','<a href="javascript:void(0)" ng-click="paginateYears(paginationYears[0])" ng-class="{\'_720kb-datepicker-item-hidden\': paginationYearsPrevDisabled}">',e,"</a>",'<a href="javascript:void(0)" ng-click="paginateYears(paginationYears[paginationYears.length -1 ])" ng-class="{\'_720kb-datepicker-item-hidden\': paginationYearsNextDisabled}">',a,"</a>","</div>","</div>"]},d=function(){return['<div class="_720kb-datepicker-calendar-days-header">','<div ng-repeat="d in daysInString">',"{{d}}","</div>","</div>"]},l=function(){return['<div class="_720kb-datepicker-calendar-body">','<a href="javascript:void(0)" ng-repeat="px in prevMonthDays" class="_720kb-datepicker-calendar-day _720kb-datepicker-disabled">',"{{px}}","</a>","<a href=\"javascript:void(0)\" ng-repeat=\"item in days\" ng-click=\"setDatepickerDay(item)\" ng-class=\"{'_720kb-datepicker-active': selectedDay === item && selectedMonth === monthNumber && selectedYear === year, '_720kb-datepicker-disabled': !isSelectableMinDate(year + '/' + monthNumber + '/' + item ) || !isSelectableMaxDate(year + '/' + monthNumber + '/' + item) || !isSelectableDate(monthNumber, year, item) || !isSelectableDay(monthNumber, year, item),'_720kb-datepicker-today': item === today.getDate() && monthNumber === (today.getMonth() + 1) && year === today.getFullYear() && !selectedDay}\" class=\"_720kb-datepicker-calendar-day\">","{{item}}","</a>",'<a href="javascript:void(0)" ng-repeat="nx in nextMonthDays" class="_720kb-datepicker-calendar-day _720kb-datepicker-disabled">',"{{nx}}","</a>","</div>"]},c=function(e,a,t){var n=['<div class="_720kb-datepicker-calendar {{datepickerClass}} {{datepickerID}}" ng-class="{\'_720kb-datepicker-forced-to-open\': checkVisibility()}" ng-blur="hideCalendar()">',"</div>"],c=i(e,a,t),o=r(e,a),s=d(),m=l(),u=function(e){n.splice(n.length-1,0,e)};return c.forEach(u),o.forEach(u),s.forEach(u),m.forEach(u),n.join("")},o=function(a,i,r,d,l,o){var s=function(s,m,u){var b,h,y,p=u.selector,g=e.element(p?m[0].querySelector("."+p):m[0].children[0]),M='<b class="_720kb-datepicker-default-button">&lang;</b>',k='<b class="_720kb-datepicker-default-button">&rang;</b>',f=u.buttonPrev||M,D=u.buttonNext||k,v=u.dateFormat,N=s.$eval(s.dateDisabledDates),S=s.$eval(s.dateEnabledDates),w=s.$eval(s.dateDisabledWeekdays),x=new Date,Y=!1,T=!1,_="undefined"!=typeof u.datepickerMobile&&"false"!==u.datepickerMobile,L=r.DATETIME_FORMATS,$=864e5,A=c(f,D,_),P=function(){Y||T||!b||s.hideCalendar()},W=function(e,a){var t,n,i,r,d,l=new Date(a,e,0).getDate(),c=new Date(a+"/"+e+"/1").getDay(),o=new Date(a+"/"+e+"/"+l).getDay(),m=[],u=[];for(s.days=[],s.dateWeekStartDay=s.validateWeekDay(s.dateWeekStartDay),d=(s.dateWeekStartDay+6)%7,t=1;l>=t;t+=1)s.days.push(t);if(c===s.dateWeekStartDay)s.prevMonthDays=[];else{for(i=c-s.dateWeekStartDay,c<s.dateWeekStartDay&&(i+=7),r=1===Number(e)?12:e-1,t=1;t<=new Date(a,r,0).getDate();t+=1)m.push(t);s.prevMonthDays=m.slice(-i)}if(o===d)s.nextMonthDays=[];else{for(n=6-o+s.dateWeekStartDay,o<s.dateWeekStartDay&&(n-=7),t=1;n>=t;t+=1)u.push(t);s.nextMonthDays=u}},E=function(){s.month=d("date")(new Date(s.dateMinLimit),"MMMM"),s.monthNumber=Number(d("date")(new Date(s.dateMinLimit),"MM")),s.day=Number(d("date")(new Date(s.dateMinLimit),"dd")),s.year=Number(d("date")(new Date(s.dateMinLimit),"yyyy")),W(s.monthNumber,s.year)},H=function(){s.month=d("date")(new Date(s.dateMaxLimit),"MMMM"),s.monthNumber=Number(d("date")(new Date(s.dateMaxLimit),"MM")),s.day=Number(d("date")(new Date(s.dateMaxLimit),"dd")),s.year=Number(d("date")(new Date(s.dateMaxLimit),"yyyy")),W(s.monthNumber,s.year)},O=function(){s.year=Number(s.year)-1},F=function(){s.year=Number(s.year)+1},j=function(e,a){var t,n,i,r,d,l,c,o,s,m=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|MMMM|MMM|MM|M|dd?d?|yy?yy?y?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(l=0;l<L.MONTH.length;l+=1){if(o=L.MONTH[l],s=L.SHORTMONTH[l],-1!==e.indexOf(o)){e=e.replace(o,l+1);break}if(-1!==e.indexOf(s)){e=e.replace(s,l+1);break}}for(n=e.split(/\D/).filter(function(e){return e.length>0}),t=a.match(m).filter(function(e){return null!==e.match(/^[a-zA-Z]+$/i)}),l=0;l<t.length;l+=1)switch(c=t[l],!0){case-1!==c.indexOf("d"):r=n[l-(t.length-n.length)];break;case-1!==c.indexOf("M"):i=n[l-(t.length-n.length)];break;case-1!==c.indexOf("y"):d=n[l-(t.length-n.length)]}return new Date(d+"/"+i+"/"+r)},I=function(){if(!s.isSelectableMinDate(s.year+"/"+s.monthNumber+"/"+s.day)||!s.isSelectableMaxDate(s.year+"/"+s.monthNumber+"/"+s.day))return!1;var e=new Date(s.year+"/"+s.monthNumber+"/"+s.day);u.dateFormat?g.val(d("date")(e,v)):g.val(e),g.triggerHandler("input"),g.triggerHandler("change")},C={add:function(e,a){var t;e.className.indexOf(a)>-1||(t=e.className.split(" "),t.push(a),e.className=t.join(" "))},remove:function(e,a){var t,n;if(-1!==e.className.indexOf(a)){for(n=e.className.split(" "),t=0;t<n.length;t+=1)if(n[t]===a){n=n.slice(0,t).concat(n.slice(t+1));break}e.className=n.join(" ")}}},B=function(){h=a.document.getElementsByClassName("_720kb-datepicker-calendar"),e.forEach(h,function(e,a){h[a].classList?h[a].classList.remove("_720kb-datepicker-open"):C.remove(h[a],"_720kb-datepicker-open")}),b.classList?(b.classList.add("_720kb-datepicker-open"),x=v?j(g[0].value.toString(),v):new Date(g[0].value.toString()),s.selectedMonth=Number(d("date")(x,"MM")),s.selectedDay=Number(d("date")(x,"dd")),s.selectedYear=Number(d("date")(x,"yyyy"))):C.add(b,"_720kb-datepicker-open"),s.today=new Date,o(function(){s.selectedDay?(s.year=s.selectedYear,s.monthNumber=s.selectedMonth):(s.year=s.today.getFullYear(),s.monthNumber=s.today.getMonth()+1),s.month=d("date")(new Date(s.year,s.monthNumber-1),"MMMM"),W(s.monthNumber,s.year)},0)},G=function(){return s.datepickerToggle?s.$eval(s.datepickerToggle):!0},z=function(){return s.datepickerShow?(x=v?j(g[0].value.toString(),v):new Date(g[0].value.toString()),s.selectedMonth=Number(d("date")(x,"MM")),s.selectedDay=Number(d("date")(x,"dd")),s.selectedYear=Number(d("date")(x,"yyyy")),s.$eval(s.datepickerShow)):!1},R=s.$watch("dateSet",function(e){e&&!isNaN(Date.parse(e))&&(x=new Date(e),s.month=d("date")(x,"MMMM"),s.monthNumber=Number(d("date")(x,"MM")),s.day=Number(d("date")(x,"dd")),s.year=Number(d("date")(x,"yyyy")),W(s.monthNumber,s.year),"true"!==s.dateSetHidden&&I())}),Z=s.$watch("dateMinLimit",function(e){e&&E()}),q=s.$watch("dateMaxLimit",function(e){e&&H()}),V=s.$watch("dateFormat",function(e){e&&I()}),X=s.$watch("dateDisabledDates",function(e){e&&(N=s.$eval(e),s.isSelectableDate(s.monthNumber,s.year,s.day)||(g.val(""),g.triggerHandler("input"),g.triggerHandler("change")))}),J=s.$watch("dateEnabledDates",function(e){e&&(S=s.$eval(e),s.isSelectableDate(s.monthNumber,s.year,s.day)||(g.val(""),g.triggerHandler("input"),g.triggerHandler("change")))});for(s.nextMonth=function(){12===s.monthNumber?(s.monthNumber=1,F()):s.monthNumber+=1,s.dateMaxLimit&&(s.isSelectableMaxDate(s.year+"/"+s.monthNumber+"/"+s.days[0])||H()),s.month=d("date")(new Date(s.year,s.monthNumber-1),"MMMM"),W(s.monthNumber,s.year),s.day=void 0},s.willPrevMonthBeSelectable=function(){var e=s.monthNumber,a=s.year,t=d("date")(new Date(new Date(a+"/"+e+"/01").getTime()-$),"dd");return 1===e?(e=12,a-=1):e-=1,s.dateMinLimit&&!s.isSelectableMinDate(a+"/"+e+"/"+t)?!1:!0},s.willNextMonthBeSelectable=function(){var e=s.monthNumber,a=s.year;return 12===e?(e=1,a+=1):e+=1,s.dateMaxLimit&&!s.isSelectableMaxDate(a+"/"+e+"/01")?!1:!0},s.prevMonth=function(){1===s.monthNumber?(s.monthNumber=12,O()):s.monthNumber-=1,s.dateMinLimit&&(s.isSelectableMinDate(s.year+"/"+s.monthNumber+"/"+s.days[s.days.length-1])||E()),s.month=d("date")(new Date(s.year,s.monthNumber-1),"MMMM"),W(s.monthNumber,s.year),s.day=void 0},s.selectedMonthHandle=function(e){s.monthNumber=Number(d("date")(new Date(e+"/01/2000"),"MM")),W(s.monthNumber,s.year),I()},s.setNewYear=function(e){if(n||(s.day=void 0),s.dateMaxLimit&&s.year<Number(e)){if(!s.isSelectableMaxYear(e))return}else if(s.dateMinLimit&&s.year>Number(e)&&!s.isSelectableMinYear(e))return;s.paginateYears(e),s.showYearsPagination=!1,o(function(){s.year=Number(e),W(s.monthNumber,s.year)},0)},s.hideCalendar=function(){b.classList?b.classList.remove("_720kb-datepicker-open"):C.remove(b,"_720kb-datepicker-open")},s.setDatepickerDay=function(e){s.isSelectableDay(s.monthNumber,s.year,e)&&s.isSelectableDate(s.monthNumber,s.year,e)&&s.isSelectableMaxDate(s.year+"/"+s.monthNumber+"/"+e)&&s.isSelectableMinDate(s.year+"/"+s.monthNumber+"/"+e)&&(s.day=Number(e),s.selectedDay=s.day,s.selectedMonth=s.monthNumber,s.selectedYear=s.year,I(),u.hasOwnProperty("dateRefocus")&&g[0].focus(),s.hideCalendar())},s.paginateYears=function(e){var a,t=[],i=10,r=10;for(s.paginationYears=[],n&&(i=50,r=50,s.dateMinLimit&&s.dateMaxLimit&&(e=new Date(s.dateMaxLimit).getFullYear(),i=e-new Date(s.dateMinLimit).getFullYear(),r=1)),a=i;a>0;a-=1)t.push(Number(e)-a);for(a=0;r>a;a+=1)t.push(Number(e)+a);"true"===s.dateTyper&&g.on("keyup blur",function(){if(g[0].value&&g[0].value.length&&g[0].value.length>0)try{x=v?j(g[0].value.toString(),v):new Date(g[0].value.toString()),x.getFullYear()&&!isNaN(x.getDay())&&!isNaN(x.getMonth())&&s.isSelectableDay(x.getMonth(),x.getFullYear(),x.getDay())&&s.isSelectableDate(x.getMonth(),x.getFullYear(),x.getDay())&&s.isSelectableMaxDate(x)&&s.isSelectableMinDate(x)&&s.$apply(function(){s.month=d("date")(x,"MMMM"),s.monthNumber=Number(d("date")(x,"MM")),s.day=Number(d("date")(x,"dd")),4===x.getFullYear().toString().length&&(s.year=Number(d("date")(x,"yyyy"))),W(s.monthNumber,s.year)})}catch(e){return e}}),s.dateMaxLimit&&t&&t.length&&!s.isSelectableMaxYear(Number(t[t.length-1])+1)?s.paginationYearsNextDisabled=!0:s.paginationYearsNextDisabled=!1,s.dateMinLimit&&t&&t.length&&!s.isSelectableMinYear(Number(t[0])-1)?s.paginationYearsPrevDisabled=!0:s.paginationYearsPrevDisabled=!1,s.paginationYears=t},s.isSelectableDay=function(e,a,t){var n=0;if(w&&w.length>0)for(n;n<=w.length;n+=1)if(w[n]===new Date(e+"/"+t+"/"+a).getDay())return!1;return!0},s.isSelectableDate=function(e,a,t){var n=0;if(N&&N.length>0)for(n;n<=N.length;n+=1)if(new Date(N[n]).getTime()===new Date(e+"/"+t+"/"+a).getTime())return!1;if(S){for(n;n<=S.length;n+=1)if(new Date(S[n]).getTime()===new Date(e+"/"+t+"/"+a).getTime())return!0;return!1}return!0},s.isSelectableMinDate=function(e){return s.dateMinLimit&&new Date(s.dateMinLimit)&&new Date(e).getTime()<new Date(s.dateMinLimit).getTime()?!1:!0},s.isSelectableMaxDate=function(e){return s.dateMaxLimit&&new Date(s.dateMaxLimit)&&new Date(e).getTime()>new Date(s.dateMaxLimit).getTime()?!1:!0},s.isSelectableMaxYear=function(e){return s.dateMaxLimit&&e>new Date(s.dateMaxLimit).getFullYear()?!1:!0},s.isSelectableMinYear=function(e){return s.dateMinLimit&&e<new Date(s.dateMinLimit).getFullYear()?!1:!0},s.validateWeekDay=function(e){var a=Number(e,10);return(!a||0>a||a>6)&&(a=0),a},A=A.replace(/{{/g,l.startSymbol()).replace(/}}/g,l.endSymbol()),s.dateMonthTitle=s.dateMonthTitle||"Select month",s.dateYearTitle=s.dateYearTitle||"Select year",s.buttonNextTitle=s.buttonNextTitle||"Next",s.buttonPrevTitle=s.buttonPrevTitle||"Prev",s.month=d("date")(x,"MMMM"),s.monthNumber=Number(d("date")(x,"MM")),s.day=Number(d("date")(x,"dd")),s.dateWeekStartDay=s.validateWeekDay(s.dateWeekStartDay),s.dateMaxLimit?s.year=Number(d("date")(new Date(s.dateMaxLimit),"yyyy")):s.year=Number(d("date")(x,"yyyy")),s.months=L.MONTH,s.daysInString=[],y=s.dateWeekStartDay;y<=s.dateWeekStartDay+6;y+=1)s.daysInString.push(y%7);s.daysInString=s.daysInString.map(function(e){return d("date")(new Date(new Date("06/08/2014").valueOf()+t*e),"EEE")}),s.datepickerAppendTo&&-1!==s.datepickerAppendTo.indexOf(".")?(s.datepickerID="datepicker-id-"+(new Date).getTime()+(Math.floor(6*Math.random())+8),e.element(document.getElementsByClassName(s.datepickerAppendTo.replace(".",""))[0]).append(i(e.element(A))(s,function(a){b=e.element(a)[0]}))):s.datepickerAppendTo&&-1!==s.datepickerAppendTo.indexOf("#")?(s.datepickerID="datepicker-id-"+(new Date).getTime()+(Math.floor(6*Math.random())+8),e.element(document.getElementById(s.datepickerAppendTo.replace("#",""))).append(i(e.element(A))(s,function(a){b=e.element(a)[0]}))):s.datepickerAppendTo&&"body"===s.datepickerAppendTo?(s.datepickerID="datepicker-id-"+((new Date).getTime()+(Math.floor(6*Math.random())+8)),e.element(document).find("body").append(i(e.element(A))(s,function(a){b=e.element(a)[0]}))):(g.after(i(e.element(A))(s)),b=m[0].querySelector("._720kb-datepicker-calendar")),G()&&g.on("focus click focusin",function(){T=!0,Y||T||!b?B():s.hideCalendar()}),g.on("focusout blur",function(){T=!1}),e.element(b).on("mouseenter",function(){Y=!0}),e.element(b).on("mouseleave",function(){Y=!1}),e.element(b).on("focusin",function(){Y=!0}),e.element(a).on("click focus focusin",P),(s.dateMinLimit&&!s.isSelectableMinYear(s.year)||!s.isSelectableMinDate(s.year+"/"+s.monthNumber+"/"+s.day))&&E(),(s.dateMaxLimit&&!s.isSelectableMaxYear(s.year)||!s.isSelectableMaxDate(s.year+"/"+s.monthNumber+"/"+s.day))&&H(),s.paginateYears(s.year),W(s.monthNumber,s.year),s.checkVisibility=z,s.$on("$destroy",function(){R(),Z(),q(),V(),X(),J(),g.off("focus click focusout blur"),e.element(b).off("mouseenter mouseleave focusin"),e.element(a).off("click focus focusin",P)})};return{restrict:"AEC",scope:{dateSet:"@",dateMinLimit:"@",dateMaxLimit:"@",dateMonthTitle:"@",dateYearTitle:"@",buttonNextTitle:"@",buttonPrevTitle:"@",dateDisabledDates:"@",dateEnabledDates:"@",dateDisabledWeekdays:"@",dateSetHidden:"@",dateTyper:"@",dateWeekStartDay:"@",datepickerAppendTo:"@",datepickerToggle:"@",datepickerClass:"@",datepickerShow:"@"},link:s}};e.module("720kb.datepicker",[]).directive("datepicker",["$window","$compile","$locale","$filter","$interpolate","$timeout",o])}(angular,navigator);